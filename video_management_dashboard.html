<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>The Hot Pot Spot - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ–º</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .dashboard-container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.2em;
            opacity: 0.9;
        }

        .nav-tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 1px solid #dee2e6;
        }

        .nav-tab {
            flex: 1;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            border: none;
            background: transparent;
            font-size: 1.1em;
            font-weight: 600;
            transition: all 0.3s ease;
            color: #6c757d;
        }

        .nav-tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .nav-tab:hover {
            background: #e9ecef;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
        }

        .card h3 {
            color: #333;
            margin-bottom: 15px;
            font-size: 1.3em;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .card-icon {
            font-size: 1.5em;
        }

        .status-indicator {
            display: inline-block;
            width: 12px;
            height: 12px;
            border-radius: 50%;
            margin-right: 8px;
        }

        .status-active {
            background: #28a745;
        }

        .status-inactive {
            background: #dc3545;
        }

        .status-recording {
            background: #ffc107;
            animation: pulse 1s infinite;
        }

        .status-streaming {
            background: #17a2b8;
            animation: pulse 1s infinite;
        }

        @keyframes pulse {
            0% { opacity: 1; }
            50% { opacity: 0.5; }
            100% { opacity: 1; }
        }

        .btn {
            padding: 12px 24px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin: 5px;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, #5a6fd8, #6a4190);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-success {
            background: linear-gradient(135deg, #28a745, #20c997);
            color: white;
        }

        .btn-success:hover {
            background: linear-gradient(135deg, #218838, #1ea085);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(40, 167, 69, 0.3);
        }

        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #e74c3c);
            color: white;
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, #c82333, #d63031);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(220, 53, 69, 0.3);
        }

        .btn-warning {
            background: linear-gradient(135deg, #ffc107, #fd7e14);
            color: white;
        }

        .btn-warning:hover {
            background: linear-gradient(135deg, #e0a800, #e55a00);
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 193, 7, 0.3);
        }

        .btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none !important;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .table th,
        .table td {
            padding: 15px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }

        .table th {
            background: #f8f9fa;
            font-weight: 600;
            color: #495057;
        }

        .table tbody tr:hover {
            background: #f8f9fa;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }

        .form-control {
            width: 100%;
            padding: 12px;
            border: 1px solid #ced4da;
            border-radius: 8px;
            font-size: 1em;
            transition: border-color 0.3s ease;
        }

        .form-control:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }

        .alert {
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            border: 1px solid transparent;
        }

        .alert-success {
            background: #d4edda;
            color: #155724;
            border-color: #c3e6cb;
        }

        .alert-danger {
            background: #f8d7da;
            color: #721c24;
            border-color: #f5c6cb;
        }

        .alert-warning {
            background: #fff3cd;
            color: #856404;
            border-color: #ffeaa7;
        }

        .alert-info {
            background: #d1ecf1;
            color: #0c5460;
            border-color: #bee5eb;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 25px;
            border-radius: 15px;
            text-align: center;
        }

        .stat-card h4 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .stat-card p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .video-preview {
            width: 100%;
            height: 200px;
            background: #000;
            border-radius: 10px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 1.2em;
            margin-bottom: 15px;
        }

        .stream-info {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 10px;
            margin-top: 15px;
        }

        .stream-info h5 {
            color: #333;
            margin-bottom: 10px;
        }

        .stream-info p {
            color: #666;
            margin-bottom: 5px;
        }

        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
        }

        .modal-content {
            background: white;
            margin: 5% auto;
            padding: 30px;
            border-radius: 15px;
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 1px solid #dee2e6;
        }

        .modal-header h3 {
            color: #333;
            margin: 0;
        }

        .close {
            font-size: 2em;
            cursor: pointer;
            color: #999;
        }

        .close:hover {
            color: #333;
        }

        @media (max-width: 768px) {
            .nav-tabs {
                flex-direction: column;
            }

            .form-row {
                grid-template-columns: 1fr;
            }

            .grid {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="dashboard-container">
        <div class="header">
            <h1>üç≤ The Hot Pot Spot</h1>
            <p>–°–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤–∏–¥–µ–æ–Ω–∞–±–ª—é–¥–µ–Ω–∏–µ–º –∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–æ–º</p>
        </div>

        <div class="nav-tabs">
            <button class="nav-tab active" onclick="switchTab('overview')">üìä –û–±–∑–æ—Ä</button>
            <button class="nav-tab" onclick="switchTab('cameras')">üìπ –ö–∞–º–µ—Ä—ã</button>
            <button class="nav-tab" onclick="switchTab('recordings')">üé• –ó–∞–ø–∏—Å–∏</button>
            <button class="nav-tab" onclick="switchTab('streaming')">üì° –°—Ç—Ä–∏–º–∏–Ω–≥</button>
            <button class="nav-tab" onclick="switchTab('consents')">üìã –°–æ–≥–ª–∞—Å–∏—è</button>
            <button class="nav-tab" onclick="switchTab('settings')">‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏</button>
        </div>

        <!-- –û–±–∑–æ—Ä -->
        <div id="overview" class="tab-content active">
            <div class="stats-grid">
                <div class="stat-card">
                    <h4 id="totalCameras">0</h4>
                    <p>–í—Å–µ–≥–æ –∫–∞–º–µ—Ä</p>
                </div>
                <div class="stat-card">
                    <h4 id="activeRecordings">0</h4>
                    <p>–ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π</p>
                </div>
                <div class="stat-card">
                    <h4 id="activeStreams">0</h4>
                    <p>–ê–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∏–º–æ–≤</p>
                </div>
                <div class="stat-card">
                    <h4 id="totalViewers">0</h4>
                    <p>–ó—Ä–∏—Ç–µ–ª–µ–π –æ–Ω–ª–∞–π–Ω</p>
                </div>
            </div>

            <div class="grid">
                <div class="card">
                    <h3><span class="card-icon">üìπ</span> –°—Ç–∞—Ç—É—Å –∫–∞–º–µ—Ä</h3>
                    <div id="cameraStatusList">
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>

                <div class="card">
                    <h3><span class="card-icon">üé•</span> –ê–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∏</h3>
                    <div id="activeRecordingsList">
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>

                <div class="card">
                    <h3><span class="card-icon">üì°</span> –°—Ç—Ä–∏–º—ã</h3>
                    <div id="activeStreamsList">
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>

                <div class="card">
                    <h3><span class="card-icon">üìã</span> –ü–æ—Å–ª–µ–¥–Ω–∏–µ —Å–æ–≥–ª–∞—Å–∏—è</h3>
                    <div id="recentConsentsList">
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>
            </div>
        </div>

        <!-- –ö–∞–º–µ—Ä—ã -->
        <div id="cameras" class="tab-content">
            <div class="card">
                <h3><span class="card-icon">üìπ</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–µ—Ä–∞–º–∏</h3>
                <button class="btn btn-primary" onclick="openAddCameraModal()">–î–æ–±–∞–≤–∏—Ç—å –∫–∞–º–µ—Ä—É</button>
                
                <table class="table">
                    <thead>
                        <tr>
                            <th>ID</th>
                            <th>–¢–∏–ø</th>
                            <th>–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="camerasTableBody">
                        <tr>
                            <td colspan="6">–ó–∞–≥—Ä—É–∑–∫–∞...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- –ó–∞–ø–∏—Å–∏ -->
        <div id="recordings" class="tab-content">
            <div class="card">
                <h3><span class="card-icon">üé•</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å—è–º–∏</h3>
                
                <table class="table">
                    <thead>
                        <tr>
                            <th>ID –∑–∞–ø–∏—Å–∏</th>
                            <th>–ö–∞–º–µ—Ä–∞</th>
                            <th>–ö–ª–∏–µ–Ω—Ç</th>
                            <th>–ù–∞—á–∞–ª–æ</th>
                            <th>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="recordingsTableBody">
                        <tr>
                            <td colspan="7">–ó–∞–≥—Ä—É–∑–∫–∞...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- –°—Ç—Ä–∏–º–∏–Ω–≥ -->
        <div id="streaming" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3><span class="card-icon">üì°</span> –ê–∫—Ç–∏–≤–Ω—ã–µ —Å—Ç—Ä–∏–º—ã</h3>
                    <div id="streamingList">
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>

                <div class="card">
                    <h3><span class="card-icon">üìä</span> –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–ª–∞—Ç—Ñ–æ—Ä–º</h3>
                    <div id="platformStats">
                        <p>–ó–∞–≥—Ä—É–∑–∫–∞...</p>
                    </div>
                </div>
            </div>

            <div class="card">
                <h3><span class="card-icon">üé¨</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç—Ä–∏–º–∞–º–∏</h3>
                <button class="btn btn-success" onclick="startGlobalStream()">–ó–∞–ø—É—Å—Ç–∏—Ç—å –≥–ª–æ–±–∞–ª—å–Ω—ã–π —Å—Ç—Ä–∏–º</button>
                <button class="btn btn-danger" onclick="stopAllStreams()">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–∏–º—ã</button>
            </div>
        </div>

        <!-- –°–æ–≥–ª–∞—Å–∏—è -->
        <div id="consents" class="tab-content">
            <div class="card">
                <h3><span class="card-icon">üìã</span> –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–≥–ª–∞—Å–∏—è–º–∏</h3>
                
                <table class="table">
                    <thead>
                        <tr>
                            <th>–ö–ª–∏–µ–Ω—Ç</th>
                            <th>–°—Ç–æ–ª</th>
                            <th>–í—Ä–µ–º—è —Å–æ–≥–ª–∞—Å–∏—è</th>
                            <th>–ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è</th>
                            <th>–°—Ç–∞—Ç—É—Å</th>
                            <th>–î–µ–π—Å—Ç–≤–∏—è</th>
                        </tr>
                    </thead>
                    <tbody id="consentsTableBody">
                        <tr>
                            <td colspan="6">–ó–∞–≥—Ä—É–∑–∫–∞...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ -->
        <div id="settings" class="tab-content">
            <div class="grid">
                <div class="card">
                    <h3><span class="card-icon">üîß</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ç—Ä–∏–º–∏–Ω–≥–∞</h3>
                    <div class="form-group">
                        <label>–ö–∞—á–µ—Å—Ç–≤–æ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:</label>
                        <select class="form-control" id="defaultQuality">
                            <option value="low">480p (–ù–∏–∑–∫–æ–µ)</option>
                            <option value="medium" selected>720p (–°—Ä–µ–¥–Ω–µ–µ)</option>
                            <option value="high">1080p (–í—ã—Å–æ–∫–æ–µ)</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–ú–∞–∫—Å–∏–º—É–º –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å—Ç—Ä–∏–º–æ–≤:</label>
                        <input type="number" class="form-control" id="maxStreams" value="5" min="1" max="20">
                    </div>
                    <button class="btn btn-primary" onclick="saveStreamingSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>

                <div class="card">
                    <h3><span class="card-icon">üîí</span> –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏</h3>
                    <div class="form-group">
                        <label>–ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é:</label>
                        <select class="form-control" id="defaultAnonymization">
                            <option value="blur">–†–∞–∑–º—ã—Ç–∏–µ –ª–∏—Ü</option>
                            <option value="replace" selected>–ó–∞–º–µ–Ω–∞ –ª–∏—Ü</option>
                            <option value="none">–ë–µ–∑ –∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø–∏—Å–∏ (–º–∏–Ω—É—Ç—ã):</label>
                        <input type="number" class="form-control" id="maxRecordingDuration" value="30" min="1" max="120">
                    </div>
                    <button class="btn btn-primary" onclick="saveAnonymizationSettings()">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
                </div>
            </div>
        </div>
    </div>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã -->
    <div id="addCameraModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–î–æ–±–∞–≤–∏—Ç—å –∫–∞–º–µ—Ä—É</h3>
                <span class="close" onclick="closeAddCameraModal()">&times;</span>
            </div>
            <form id="addCameraForm">
                <div class="form-row">
                    <div class="form-group">
                        <label>ID –∫–∞–º–µ—Ä—ã:</label>
                        <input type="text" class="form-control" id="cameraId" required>
                    </div>
                    <div class="form-group">
                        <label>–¢–∏–ø –∫–∞–º–µ—Ä—ã:</label>
                        <select class="form-control" id="cameraType" required>
                            <option value="external">–í–Ω–µ—à–Ω—è—è</option>
                            <option value="production">–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ</option>
                            <option value="confession">–û—Ç–∫—Ä–æ–≤–µ–Ω–∏—è</option>
                            <option value="customer_table">–°—Ç–æ–ª –∫–ª–∏–µ–Ω—Ç–∞</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label>–†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ:</label>
                    <input type="text" class="form-control" id="cameraLocation" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>IP –∞–¥—Ä–µ—Å:</label>
                        <input type="text" class="form-control" id="cameraIp" required>
                    </div>
                    <div class="form-group">
                        <label>–ü–æ—Ä—Ç:</label>
                        <input type="number" class="form-control" id="cameraPort" value="8080" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label>–†–∞–∑—Ä–µ—à–µ–Ω–∏–µ:</label>
                        <select class="form-control" id="cameraResolution">
                            <option value="854x480">480p</option>
                            <option value="1280x720" selected>720p</option>
                            <option value="1920x1080">1080p</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label>FPS:</label>
                        <input type="number" class="form-control" id="cameraFps" value="30" min="15" max="60">
                    </div>
                </div>
                <div class="form-group">
                    <label>–ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è:</label>
                    <select class="form-control" id="cameraAnonymization">
                        <option value="blur">–†–∞–∑–º—ã—Ç–∏–µ –ª–∏—Ü</option>
                        <option value="replace" selected>–ó–∞–º–µ–Ω–∞ –ª–∏—Ü</option>
                        <option value="none">–ë–µ–∑ –∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏–∏</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="cameraRequiresConsent"> –¢—Ä–µ–±—É–µ—Ç —Å–æ–≥–ª–∞—Å–∏–µ –∫–ª–∏–µ–Ω—Ç–∞
                    </label>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="cameraStreamToTwitch"> –°—Ç—Ä–∏–º–∏—Ç—å –Ω–∞ Twitch
                    </label>
                </div>
                <div class="form-group">
                    <label>
                        <input type="checkbox" id="cameraStreamToYouTube"> –°—Ç—Ä–∏–º–∏—Ç—å –Ω–∞ YouTube
                    </label>
                </div>
                <div style="text-align: right; margin-top: 20px;">
                    <button type="button" class="btn btn-danger" onclick="closeAddCameraModal()">–û—Ç–º–µ–Ω–∞</button>
                    <button type="submit" class="btn btn-success">–î–æ–±–∞–≤–∏—Ç—å –∫–∞–º–µ—Ä—É</button>
                </div>
            </form>
        </div>
    </div>

    <script>
        let currentTab = 'overview';
        let cameras = [];
        let recordings = [];
        let streams = [];
        let consents = [];

        // –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –≤–∫–ª–∞–¥–æ–∫
        function switchTab(tabName) {
            // –£–±–∏—Ä–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å —Å–æ –≤—Å–µ—Ö –≤–∫–ª–∞–¥–æ–∫ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
            document.querySelectorAll('.nav-tab').forEach(tab => tab.classList.remove('active'));
            document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
            
            // –î–æ–±–∞–≤–ª—è–µ–º –∞–∫—Ç–∏–≤–Ω—ã–π –∫–ª–∞—Å—Å –∫ –≤—ã–±—Ä–∞–Ω–Ω–æ–π –≤–∫–ª–∞–¥–∫–µ –∏ –∫–æ–Ω—Ç–µ–Ω—Ç—É
            event.target.classList.add('active');
            document.getElementById(tabName).classList.add('active');
            
            currentTab = tabName;
            
            // –ó–∞–≥—Ä—É–∂–∞–µ–º –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∞–∫—Ç–∏–≤–Ω–æ–π –≤–∫–ª–∞–¥–∫–∏
            loadTabData(tabName);
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –≤–∫–ª–∞–¥–∫–∏
        async function loadTabData(tabName) {
            switch(tabName) {
                case 'overview':
                    await loadOverviewData();
                    break;
                case 'cameras':
                    await loadCamerasData();
                    break;
                case 'recordings':
                    await loadRecordingsData();
                    break;
                case 'streaming':
                    await loadStreamingData();
                    break;
                case 'consents':
                    await loadConsentsData();
                    break;
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –æ–±–∑–æ—Ä–∞
        async function loadOverviewData() {
            try {
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                const statsResponse = await fetch('/api/video-cameras/stats');
                const stats = await statsResponse.json();
                
                document.getElementById('totalCameras').textContent = stats.data?.total_cameras || 0;
                document.getElementById('activeRecordings').textContent = stats.data?.active_recordings || 0;
                document.getElementById('activeStreams').textContent = stats.data?.active_streams || 0;
                document.getElementById('totalViewers').textContent = stats.data?.total_viewers || 0;

                // –ó–∞–≥—Ä—É–∂–∞–µ–º –∞–∫—Ç–∏–≤–Ω—ã–µ –∑–∞–ø–∏—Å–∏
                const recordingsResponse = await fetch('/api/video-recording/active');
                const recordings = await recordingsResponse.json();
                
                updateActiveRecordingsList(recordings.data?.recordings || []);
                
            } catch (error) {
                console.error('Error loading overview data:', error);
                showAlert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –æ–±–∑–æ—Ä–∞', 'danger');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫–∞–º–µ—Ä
        async function loadCamerasData() {
            try {
                const response = await fetch('/api/video-cameras');
                const data = await response.json();
                cameras = data.data?.cameras || [];
                updateCamerasTable();
            } catch (error) {
                console.error('Error loading cameras data:', error);
                showAlert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∫–∞–º–µ—Ä', 'danger');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
        async function loadRecordingsData() {
            try {
                const response = await fetch('/api/video-recording/active');
                const data = await response.json();
                recordings = data.data?.recordings || [];
                updateRecordingsTable();
            } catch (error) {
                console.error('Error loading recordings data:', error);
                showAlert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π', 'danger');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
        async function loadStreamingData() {
            try {
                // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å API –≤—ã–∑–æ–≤—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∏–º–∏–Ω–≥–∞
                updateStreamingList();
                updatePlatformStats();
            } catch (error) {
                console.error('Error loading streaming data:', error);
                showAlert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å—Ç—Ä–∏–º–∏–Ω–≥–∞', 'danger');
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–∏–π
        async function loadConsentsData() {
            try {
                // –ó–¥–µ—Å—å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å API –≤—ã–∑–æ–≤—ã –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–∏–π
                updateConsentsTable();
            } catch (error) {
                console.error('Error loading consents data:', error);
                showAlert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö —Å–æ–≥–ª–∞—Å–∏–π', 'danger');
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π
        function updateActiveRecordingsList(recordings) {
            const container = document.getElementById('activeRecordingsList');
            
            if (recordings.length === 0) {
                container.innerHTML = '<p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø–∏—Å–µ–π</p>';
                return;
            }

            const html = recordings.map(recording => `
                <div class="stream-info">
                    <h5>${recording.camera_id}</h5>
                    <p>–ö–ª–∏–µ–Ω—Ç: ${recording.customer_id || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</p>
                    <p>–ù–∞—á–∞–ª–æ: ${new Date(recording.start_time * 1000).toLocaleString()}</p>
                    <p>–î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: ${Math.floor((Date.now() / 1000 - recording.start_time) / 60)} –º–∏–Ω</p>
                </div>
            `).join('');

            container.innerHTML = html;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∫–∞–º–µ—Ä
        function updateCamerasTable() {
            const tbody = document.getElementById('camerasTableBody');
            
            if (cameras.length === 0) {
                tbody.innerHTML = '<tr><td colspan="6">–ù–µ—Ç –∫–∞–º–µ—Ä</td></tr>';
                return;
            }

            const html = cameras.map(camera => `
                <tr>
                    <td>${camera.camera_id}</td>
                    <td>${getCameraTypeName(camera.camera_type)}</td>
                    <td>${camera.location}</td>
                    <td><span class="status-indicator status-active"></span>–ê–∫—Ç–∏–≤–Ω–∞</td>
                    <td>${getAnonymizationName(camera.anonymization_zone)}</td>
                    <td>
                        <button class="btn btn-primary" onclick="startCameraRecording('${camera.camera_id}')">–ó–∞–ø–∏—Å—å</button>
                        <button class="btn btn-warning" onclick="startCameraStream('${camera.camera_id}')">–°—Ç—Ä–∏–º</button>
                        <button class="btn btn-danger" onclick="removeCamera('${camera.camera_id}')">–£–¥–∞–ª–∏—Ç—å</button>
                    </td>
                </tr>
            `).join('');

            tbody.innerHTML = html;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –∑–∞–ø–∏—Å–µ–π
        function updateRecordingsTable() {
            const tbody = document.getElementById('recordingsTableBody');
            
            if (recordings.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7">–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π</td></tr>';
                return;
            }

            const html = recordings.map(recording => `
                <tr>
                    <td>${recording.recording_id}</td>
                    <td>${recording.camera_id}</td>
                    <td>${recording.customer_id || '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ'}</td>
                    <td>${new Date(recording.start_time * 1000).toLocaleString()}</td>
                    <td>${recording.end_time ? Math.floor((recording.end_time - recording.start_time) / 60) : '–í –ø—Ä–æ—Ü–µ—Å—Å–µ'} –º–∏–Ω</td>
                    <td><span class="status-indicator status-recording"></span>–ê–∫—Ç–∏–≤–Ω–∞</td>
                    <td>
                        <button class="btn btn-danger" onclick="stopRecording('${recording.recording_id}')">–û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å</button>
                    </td>
                </tr>
            `).join('');

            tbody.innerHTML = html;
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Å—Ç—Ä–∏–º–æ–≤
        function updateStreamingList() {
            const container = document.getElementById('streamingList');
            container.innerHTML = '<p>–ù–µ—Ç –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å—Ç—Ä–∏–º–æ–≤</p>';
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–ª–∞—Ç—Ñ–æ—Ä–º
        function updatePlatformStats() {
            const container = document.getElementById('platformStats');
            container.innerHTML = '<p>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞</p>';
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã —Å–æ–≥–ª–∞—Å–∏–π
        function updateConsentsTable() {
            const tbody = document.getElementById('consentsTableBody');
            tbody.innerHTML = '<tr><td colspan="6">–ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö</td></tr>';
        }

        // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏
        function getCameraTypeName(type) {
            const types = {
                'external': '–í–Ω–µ—à–Ω—è—è',
                'production': '–ü—Ä–æ–∏–∑–≤–æ–¥—Å—Ç–≤–æ',
                'confession': '–û—Ç–∫—Ä–æ–≤–µ–Ω–∏—è',
                'customer_table': '–°—Ç–æ–ª –∫–ª–∏–µ–Ω—Ç–∞'
            };
            return types[type] || type;
        }

        function getAnonymizationName(zone) {
            const zones = {
                'blur': '–†–∞–∑–º—ã—Ç–∏–µ',
                'replace': '–ó–∞–º–µ–Ω–∞',
                'none': '–ù–µ—Ç'
            };
            return zones[zone] || zone;
        }

        // –ú–æ–¥–∞–ª—å–Ω—ã–µ –æ–∫–Ω–∞
        function openAddCameraModal() {
            document.getElementById('addCameraModal').style.display = 'block';
        }

        function closeAddCameraModal() {
            document.getElementById('addCameraModal').style.display = 'none';
            document.getElementById('addCameraForm').reset();
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ñ–æ—Ä–º—ã –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã
        document.getElementById('addCameraForm').addEventListener('submit', async function(e) {
            e.preventDefault();
            
            const formData = {
                camera_id: document.getElementById('cameraId').value,
                camera_type: document.getElementById('cameraType').value,
                location: document.getElementById('cameraLocation').value,
                ip_address: document.getElementById('cameraIp').value,
                port: parseInt(document.getElementById('cameraPort').value),
                resolution: document.getElementById('cameraResolution').value.split('x'),
                fps: parseInt(document.getElementById('cameraFps').value),
                anonymization_zone: document.getElementById('cameraAnonymization').value,
                requires_consent: document.getElementById('cameraRequiresConsent').checked,
                stream_to_twitch: document.getElementById('cameraStreamToTwitch').checked,
                stream_to_youtube: document.getElementById('cameraStreamToYouTube').checked
            };

            try {
                const response = await fetch('/api/video-cameras', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify(formData)
                });

                if (response.ok) {
                    showAlert('–ö–∞–º–µ—Ä–∞ —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∞', 'success');
                    closeAddCameraModal();
                    loadCamerasData();
                } else {
                    showAlert('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã', 'danger');
                }
            } catch (error) {
                console.error('Error adding camera:', error);
                showAlert('–û—à–∏–±–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞–º–µ—Ä—ã', 'danger');
            }
        });

        // –î–µ–π—Å—Ç–≤–∏—è —Å –∫–∞–º–µ—Ä–∞–º–∏
        async function startCameraRecording(cameraId) {
            try {
                const response = await fetch('/api/video-recording/start', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        camera_id: cameraId
                    })
                });

                if (response.ok) {
                    showAlert('–ó–∞–ø–∏—Å—å –Ω–∞—á–∞—Ç–∞', 'success');
                    loadRecordingsData();
                } else {
                    showAlert('–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –∑–∞–ø–∏—Å–∏', 'danger');
                }
            } catch (error) {
                console.error('Error starting recording:', error);
                showAlert('–û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –∑–∞–ø–∏—Å–∏', 'danger');
            }
        }

        async function startCameraStream(cameraId) {
            showAlert('–§—É–Ω–∫—Ü–∏—è —Å—Ç—Ä–∏–º–∏–Ω–≥–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
        }

        async function removeCamera(cameraId) {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ —É–¥–∞–ª–∏—Ç—å —ç—Ç—É –∫–∞–º–µ—Ä—É?')) {
                showAlert('–§—É–Ω–∫—Ü–∏—è —É–¥–∞–ª–µ–Ω–∏—è –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
            }
        }

        async function stopRecording(recordingId) {
            try {
                const response = await fetch('/api/video-recording/stop', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        recording_id: recordingId
                    })
                });

                if (response.ok) {
                    showAlert('–ó–∞–ø–∏—Å—å –æ—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞', 'success');
                    loadRecordingsData();
                } else {
                    showAlert('–û—à–∏–±–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–ø–∏—Å–∏', 'danger');
                }
            } catch (error) {
                console.error('Error stopping recording:', error);
                showAlert('–û—à–∏–±–∫–∞ –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–ø–∏—Å–∏', 'danger');
            }
        }

        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
        async function startGlobalStream() {
            showAlert('–§—É–Ω–∫—Ü–∏—è –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ —Å—Ç—Ä–∏–º–∞ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
        }

        async function stopAllStreams() {
            if (confirm('–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –≤—Å–µ —Å—Ç—Ä–∏–º—ã?')) {
                showAlert('–§—É–Ω–∫—Ü–∏—è –æ—Å—Ç–∞–Ω–æ–≤–∫–∏ –≤—Å–µ—Ö —Å—Ç—Ä–∏–º–æ–≤ –≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ', 'info');
            }
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∏
        async function saveStreamingSettings() {
            showAlert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        }

        async function saveAnonymizationSettings() {
            showAlert('–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã', 'success');
        }

        // –£—Ç–∏–ª–∏—Ç—ã
        function showAlert(message, type) {
            const alertDiv = document.createElement('div');
            alertDiv.className = `alert alert-${type}`;
            alertDiv.textContent = message;
            
            const container = document.querySelector('.tab-content.active');
            container.insertBefore(alertDiv, container.firstChild);
            
            setTimeout(() => {
                alertDiv.remove();
            }, 5000);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            loadOverviewData();
            
            // –ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
            setInterval(() => {
                if (currentTab === 'overview') {
                    loadOverviewData();
                }
            }, 30000);
        });

        // –ó–∞–∫—Ä—ã—Ç–∏–µ –º–æ–¥–∞–ª—å–Ω–æ–≥–æ –æ–∫–Ω–∞ –ø—Ä–∏ –∫–ª–∏–∫–µ –≤–Ω–µ –µ–≥–æ
        window.onclick = function(event) {
            const modal = document.getElementById('addCameraModal');
            if (event.target === modal) {
                closeAddCameraModal();
            }
        }
    </script>
</body>
</html>
