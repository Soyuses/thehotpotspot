# Диаграмма архитектуры Food Truck Network

## 🏗️ **Общая архитектура системы**

```
┌─────────────────────────────────────────────────────────────────┐
│                    FOOD TRUCK NETWORK                           │
│                    Blockchain Platform                          │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                    CORE LAYER                                   │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │   Recipe    │  │  Purchase   │  │    Cost     │             │
│  │ Management  │  │ Planning    │  │ Tracking    │             │
│  └─────────────┘  └─────────────┘  └─────────────┘             │
│         │                 │                 │                  │
│         ▼                 ▼                 ▼                  │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │              Token Calculator                               │ │
│  │            (1 Token = 5 Lari)                              │ │
│  └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                  BLOCKCHAIN LAYER                               │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │   PoS       │  │  Smart      │  │   Wallet    │             │
│  │ Consensus   │  │ Contracts   │  │ Management  │             │
│  └─────────────┘  └─────────────┘  └─────────────┘             │
│         │                 │                 │                  │
│         ▼                 ▼                 ▼                  │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │              Immutable Transaction History                  │ │
│  │              (Tamper-Proof Records)                        │ │
│  └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                  DATA LAYER                                     │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │ PostgreSQL  │  │    IPFS     │  │   KYC/AML   │             │
│  │ Database    │  │  Storage    │  │ Compliance  │             │
│  └─────────────┘  └─────────────┘  └─────────────┘             │
└─────────────────────────────────────────────────────────────────┘
                                │
                                ▼
┌─────────────────────────────────────────────────────────────────┐
│                  INTERFACE LAYER                                │
├─────────────────────────────────────────────────────────────────┤
│  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐             │
│  │   Web       │  │  Mobile     │  │   API       │             │
│  │ Dashboard   │  │    App      │  │ Gateway     │             │
│  └─────────────┘  └─────────────┘  └─────────────┘             │
└─────────────────────────────────────────────────────────────────┘
```

## 🔄 **Поток данных и токенов**

### **1. Customer Journey Flow**

```
Customer Order
      │
      ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│   Physical  │───▶│   QR Code   │───▶│  Mobile App │
│    Check    │    │ Generation  │    │ Download    │
└─────────────┘    └─────────────┘    └─────────────┘
      │                   │                   │
      ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ Anonymous   │    │ Wallet      │    │ Token       │
│ Wallet      │    │ Address     │    │ Transfer    │
│ Creation    │    │ Embedded    │    │ Activation  │
└─────────────┘    └─────────────┘    └─────────────┘
```

### **2. Cost Tracking & Token Emission Flow**

```
Recipe Definition
      │
      ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ Ingredient  │───▶│ Purchase    │───▶│ Actual      │
│ Calculation │    │ Planning    │    │ Purchase    │
│ (per 1000   │    │ (Auto-gen   │    │ Recording   │
│  portions)  │    │  orders)    │    │ (Verified)  │
└─────────────┘    └─────────────┘    └─────────────┘
      │                   │                   │
      ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ Cost        │    │ Supplier    │    │ Token       │
│ Estimation  │    │ Selection   │    │ Calculation │
│ (1.45 Lari) │    │ (Best       │    │ (1 Token =  │
│             │    │  prices)    │    │  5 Lari)    │
└─────────────┘    └─────────────┘    └─────────────┘
```

## 🏪 **Franchise Network Architecture**

```
┌─────────────────────────────────────────────────────────────────┐
│                    FRANCHISE NETWORK                            │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐         │
│  │ Franchise   │    │ Franchise   │    │ Franchise   │         │
│  │   Node 1    │    │   Node 2    │    │   Node N    │         │
│  │             │    │             │    │             │         │
│  │ ┌─────────┐ │    │ ┌─────────┐ │    │ ┌─────────┐ │         │
│  │ │ Recipe  │ │    │ │ Recipe  │ │    │ │ Recipe  │ │         │
│  │ │ Manager │ │    │ │ Manager │ │    │ │ Manager │ │         │
│  │ └─────────┘ │    │ └─────────┘ │    │ └─────────┘ │         │
│  │             │    │             │    │             │         │
│  │ ┌─────────┐ │    │ ┌─────────┐ │    │ ┌─────────┐ │         │
│  │ │ Cost    │ │    │ │ Cost    │ │    │ │ Cost    │ │         │
│  │ │ Tracker │ │    │ │ Tracker │ │    │ │ Tracker │ │         │
│  │ └─────────┘ │    │ └─────────┘ │    │ └─────────┘ │         │
│  └─────────────┘    └─────────────┘    └─────────────┘         │
│         │                   │                   │              │
│         └───────────────────┼───────────────────┘              │
│                             │                                  │
│                             ▼                                  │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │              Central Blockchain Network                     │ │
│  │              (PoS Consensus)                                │ │
│  └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

## 🔐 **Security & Integrity Architecture**

```
┌─────────────────────────────────────────────────────────────────┐
│                    SECURITY LAYERS                              │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                Cryptographic Layer                          │ │
│  │  • Digital Signatures (Ed25519)                            │ │
│  │  • Hash Functions (SHA-256)                                │ │
│  │  • Merkle Trees                                            │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                             │                                   │
│                             ▼                                   │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                Consensus Layer                              │ │
│  │  • Proof of Stake (PoS)                                    │ │
│  │  • Validator Selection                                     │ │
│  │  • Slashing Conditions                                     │ │
│  └─────────────────────────────────────────────────────────────┘ │
│                             │                                   │
│                             ▼                                   │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                Compliance Layer                             │ │
│  │  • KYC/AML Verification                                    │ │
│  │  • GDPR Compliance                                         │ │
│  │  • Georgian Law Compliance                                 │ │
│  └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

## 📊 **Data Flow & Token Economics**

### **Token Emission Process**

```
Actual Purchase (1320 Lari)
         │
         ▼
┌─────────────────┐
│ Cost Validation │
│ • Invoice Check │
│ • Supplier Ver. │
│ • Amount Check  │
└─────────────────┘
         │
         ▼
┌─────────────────┐
│ Token Calculation│
│ 1320 ÷ 5 = 264  │
│ Tokens to Emit  │
└─────────────────┘
         │
         ▼
┌─────────────────┐
│ Blockchain      │
│ Transaction     │
│ • Smart Contract│
│ • Token Mint    │
│ • Distribution  │
└─────────────────┘
```

### **Transparency Verification**

```
Purchase Record
      │
      ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ Invoice     │───▶│ Blockchain  │───▶│ Public      │
│ Number      │    │ Hash        │    │ Verification│
│ (INV-001)   │    │ Generation  │    │ API         │
└─────────────┘    └─────────────┘    └─────────────┘
      │                   │                   │
      ▼                   ▼                   ▼
┌─────────────┐    ┌─────────────┐    ┌─────────────┐
│ Supplier    │    │ Immutable   │    │ Real-time   │
│ Verification│    │ Record      │    │ Audit       │
│ Database    │    │ Storage     │    │ Reports     │
└─────────────┘    └─────────────┘    └─────────────┘
```

## 🎯 **Key Architectural Principles**

### **1. Immutability**
- Все транзакции записываются в блокчейн
- Хеширование обеспечивает целостность
- Невозможность подделки истории

### **2. Transparency**
- Публичная отчетность о затратах
- Верифицируемые номера счетов
- Открытый API для проверки

### **3. Fairness**
- Справедливое распределение токенов 1:1
- Прозрачная формула эмиссии
- Равные права для всех участников

### **4. Efficiency**
- Автоматическое планирование закупок
- Оптимизация поставщиков
- Минимизация потерь

### **5. Compliance**
- Соответствие регуляторным требованиям
- KYC/AML интеграция
- GDPR совместимость

## ✅ **Architecture Validation**

### **Непротиворечивость:**
- ✅ Токеномика: 1 токен = 5 лари (строго соблюдается)
- ✅ История: Неподдельная и верифицируемая
- ✅ Распределение: Справедливое соотношение 1:1
- ✅ Прозрачность: 100% закупок документированы

### **Корректность блокчейна:**
- ✅ Консенсус PoS обеспечивает безопасность
- ✅ Смарт-контракты автоматизируют эмиссию
- ✅ Криптография защищает от подделок
- ✅ Compliance обеспечивает легальность

**Заключение**: Архитектура системы непротиворечива, безопасна и готова к продуктивному использованию.
