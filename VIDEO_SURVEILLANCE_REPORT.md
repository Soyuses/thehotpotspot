# 📹 Система видеонаблюдения и стриминга The Hot Pot Spot

## Обзор системы

Система видеонаблюдения и стриминга для сети ресторанов The Hot Pot Spot представляет собой комплексное решение, включающее:

- **Видеонаблюдение** с анонимизацией лиц
- **Стриминг** на Twitch и YouTube
- **Управление согласиями** согласно законодательству Грузии
- **Автоматическая обработка** видеопотока
- **Веб-интерфейсы** для управления и согласий

## 🏗️ Архитектура системы

### Основные компоненты

```
┌─────────────────────────────────────────────────────────────────┐
│                    VIDEO SURVEILLANCE SYSTEM                   │
├─────────────────────────────────────────────────────────────────┤
│                                                                 │
│  ┌─────────────────┐    ┌─────────────────┐    ┌──────────────┐ │
│  │   CAMERAS       │    │   PROCESSING    │    │   STREAMING  │ │
│  │                 │    │                 │    │              │ │
│  │ • External      │    │ • Face Detection│    │ • Twitch     │ │
│  │ • Production    │    │ • Anonymization │    │ • YouTube    │ │
│  │ • Confession    │    │ • Consent Check │    │ • Quality    │ │
│  │ • Customer      │    │ • Frame Filter  │    │ • Management │ │
│  └─────────────────┘    └─────────────────┘    └──────────────┘ │
│           │                       │                       │      │
│           └───────────────────────┼───────────────────────┘      │
│                                   │                              │
│  ┌─────────────────────────────────────────────────────────────┐ │
│  │                    CONSENT MANAGEMENT                      │ │
│  │                                                             │ │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────────────┐  │ │
│  │  │   WEB UI    │  │   DATABASE  │  │     LEGAL COMPLIANCE│  │ │
│  │  │             │  │             │  │                     │  │ │
│  │  │ • Multi-lang│  │ • Consent   │  │ • Georgian Law      │  │ │
│  │  │ • Real-time │  │   Records   │  │ • GDPR Compliance   │  │ │
│  │  │ • Mobile    │  │ • History   │  │ • Data Protection   │  │ │
│  │  │   Friendly  │  │ • Analytics │  │ • Audit Trail       │  │ │
│  │  └─────────────┘  └─────────────┘  └─────────────────────┘  │ │
│  └─────────────────────────────────────────────────────────────┘ │
└─────────────────────────────────────────────────────────────────┘
```

## 📋 Типы камер и зоны съемки

### 1. Внешние камеры (External)
- **Расположение**: Вокруг заведения
- **Назначение**: Безопасность, мониторинг входа/выхода
- **Анонимизация**: Полное размытие лиц
- **Согласие**: Не требуется (общественное место)

### 2. Камеры производства (Production)
- **Расположение**: Кухня, зоны приготовления
- **Назначение**: Контроль качества, обучение персонала
- **Анонимизация**: Размытие лиц персонала
- **Согласие**: Не требуется (рабочее место)

### 3. Камеры откровений (Confession)
- **Расположение**: Специальная зона для отзывов
- **Назначение**: Сбор отзывов клиентов
- **Анонимизация**: По выбору клиента
- **Согласие**: Обязательно

### 4. Камеры за столами (Customer Table)
- **Расположение**: За каждым столом
- **Назначение**: Стриминг, маркетинг
- **Анонимизация**: По выбору клиента
- **Согласие**: Обязательно

## 🔒 Система анонимизации

### Уровни анонимизации

1. **Полное размытие лиц (FullFaceBlur)**
   - Автоматическое обнаружение лиц
   - Применение размытия (blur filter)
   - Защита приватности

2. **Замена лиц на аватар (FaceReplacement)**
   - Обнаружение лиц
   - Замена на выбранное изображение
   - Настраиваемые аватары

3. **Без анонимизации (NoAnonymization)**
   - Только с явного согласия
   - Ограниченное время записи
   - Специальные условия

### Технические требования

- **Обработка в реальном времени**: < 100ms задержка
- **Точность обнаружения**: > 95%
- **Поддерживаемые форматы**: H.264, H.265
- **Разрешения**: 480p, 720p, 1080p

## 📡 Система стриминга

### Поддерживаемые платформы

#### Twitch
- **Качество**: 480p, 720p, 1080p
- **Битрейт**: 1.5-6 Mbps
- **Формат**: RTMP
- **Особенности**: Чат, донаты, модерация

#### YouTube
- **Качество**: 480p, 720p, 1080p
- **Битрейт**: 1.5-6 Mbps
- **Формат**: RTMP
- **Особенности**: Монетизация, аналитика

### Управление стримами

- **Одновременные стримы**: До 5
- **Автоматическое переключение**: При сбоях
- **Мониторинг**: Статистика зрителей
- **Качество**: Адаптивное

## ⚖️ Правовое соответствие

### Законодательство Грузии

Согласно Закону Грузии "О защите персональных данных" от 14 июня 2023 года:

#### Обязательные требования:
1. **Информирование**: Заметные уведомления о видеонаблюдении
2. **Согласие**: Явное согласие для записи за столами
3. **Цель**: Указание цели видеонаблюдения
4. **Сроки**: Определение сроков хранения
5. **Доступ**: Правила доступа к данным
6. **Уничтожение**: Процедуры удаления данных

#### Запрещенные зоны:
- Комнаты для переодевания
- Санитарные помещения
- Тайное видеонаблюдение

#### Права субъектов:
- Доступ к своим данным
- Исправление неточных данных
- Удаление данных
- Отзыв согласия

### GDPR соответствие

- **Правовая основа**: Согласие (статья 6(1)(a))
- **Минимизация данных**: Только необходимые данные
- **Прозрачность**: Четкая информация о обработке
- **Безопасность**: Технические и организационные меры

## 🖥️ Пользовательские интерфейсы

### 1. Интерфейс согласия (video_consent_interface.html)

**Функции:**
- Многоязычность (русский, грузинский, английский)
- Выбор уровня анонимизации
- Информация о правах
- Юридические уведомления
- Мобильная адаптация

**Технические особенности:**
- Responsive дизайн
- Анимации и переходы
- Валидация данных
- API интеграция

### 2. Панель управления (video_management_dashboard.html)

**Функции:**
- Обзор системы
- Управление камерами
- Мониторинг записей
- Управление стримами
- Статистика согласий
- Настройки системы

**Разделы:**
- **Обзор**: Статистика, статус камер, активные записи
- **Камеры**: Добавление, настройка, управление
- **Записи**: Мониторинг, управление, история
- **Стриминг**: Запуск, остановка, статистика
- **Согласия**: Просмотр, управление, аналитика
- **Настройки**: Конфигурация системы

## 🔧 API эндпоинты

### Управление согласиями
```
POST /api/video-consent
POST /api/video-consent/confirm
GET  /api/video-consent/history/{customer_id}
POST /api/video-consent/revoke
```

### Управление записями
```
POST /api/video-recording/start
POST /api/video-recording/stop
GET  /api/video-recording/active
GET  /api/video-recording/history
```

### Управление камерами
```
GET  /api/video-cameras
POST /api/video-cameras
PUT  /api/video-cameras/{camera_id}
DELETE /api/video-cameras/{camera_id}
GET  /api/video-cameras/stats
```

### Стриминг
```
POST /api/streaming/start
POST /api/streaming/stop
GET  /api/streaming/active
GET  /api/streaming/stats
```

## 📊 Мониторинг и аналитика

### Метрики системы
- Количество активных камер
- Активные записи
- Активные стримы
- Зрители онлайн
- Статистика согласий

### Логирование
- Все операции с согласиями
- Запуск/остановка записей
- Ошибки системы
- Доступ к данным

### Алерты
- Сбои камер
- Превышение лимитов
- Нарушения согласий
- Технические проблемы

## 🚀 Развертывание

### Системные требования
- **CPU**: 8+ ядер
- **RAM**: 32+ GB
- **Storage**: 1+ TB SSD
- **Network**: 1+ Gbps
- **GPU**: Для обработки видео (опционально)

### Зависимости
- Rust 1.70+
- OpenCV (для обработки видео)
- FFmpeg (для кодирования)
- WebRTC (для стриминга)

### Конфигурация
```toml
[video_surveillance]
max_concurrent_streams = 5
default_quality = "medium"
max_recording_duration = 1800  # 30 минут
default_anonymization = "replace"

[streaming]
twitch_client_id = "your_twitch_client_id"
youtube_client_id = "your_youtube_client_id"
max_bitrate = 6000
```

## 🔐 Безопасность

### Защита данных
- Шифрование видеопотока
- Безопасное хранение согласий
- Контроль доступа
- Аудит операций

### Сетевая безопасность
- HTTPS для всех соединений
- VPN для удаленного доступа
- Firewall правила
- Мониторинг трафика

### Физическая безопасность
- Защищенные серверные комнаты
- Резервное питание
- Системы охлаждения
- Мониторинг доступа

## 📈 Планы развития

### Краткосрочные (3 месяца)
- [ ] Интеграция с реальными камерами
- [ ] Улучшение алгоритмов анонимизации
- [ ] Мобильное приложение
- [ ] Расширенная аналитика

### Среднесрочные (6 месяцев)
- [ ] AI-анализ поведения
- [ ] Автоматическое обнаружение инцидентов
- [ ] Интеграция с системами безопасности
- [ ] Облачное хранение

### Долгосрочные (12 месяцев)
- [ ] Машинное обучение для оптимизации
- [ ] Международное развертывание
- [ ] Интеграция с IoT устройствами
- [ ] Блокчейн для аудита

## 🧪 Тестирование

### Типы тестов
- **Unit тесты**: Отдельные компоненты
- **Integration тесты**: Взаимодействие компонентов
- **Performance тесты**: Нагрузочное тестирование
- **Security тесты**: Проверка уязвимостей

### Автоматизация
- CI/CD пайплайн
- Автоматические тесты
- Мониторинг качества
- Отчеты о покрытии

## 📞 Поддержка

### Документация
- Техническая документация
- Руководства пользователя
- API документация
- FAQ

### Контакты
- Техническая поддержка: support@hotpotspot.ge
- Юридические вопросы: legal@hotpotspot.ge
- Экстренные случаи: +995 XXX XXX XXX

## 📄 Лицензии

- **Основной код**: MIT License
- **OpenCV**: BSD License
- **FFmpeg**: LGPL/GPL
- **WebRTC**: BSD License

---

*Документ обновлен: Декабрь 2024*
*Версия системы: 1.0.0*
